<extend name="Public/layout"/>
<block name="head"><title>商品列表</title>
    <include file="public/style"/>
</block>
<block name="main">
<div class='row-fluid'>

    <div class='page-header' style="margin:5px 0px 0px 0px;background-color:#e7f2f8;height: 30px ">

        <div class='pull-left' >

            <ul class='breadcrumb'>
                <i class='icon-home' style="color: #000000;"></i>
                <li class='' style="margin-left: 5px;"><a href="{:url('/Admin/Index/index')}" style="color: #4c8fbd">首页</a></li>
            </ul>
        </div>

    </div>
    <div class='page-header' style="margin:5px 0px 0px 0px;background-color:#ffffff;height: 40px ;border-bottom: dotted 1px #e2e2e2">
        <div class='pull-left' >
            <ul class='breadcrumb'>


                <li class='active'><h3>商品</h3></li>


                <li class='separator'>
                    <i class='icon-angle-right'></i>
                </li>
                <li class='active'>商品分类</li>

            </ul>
        </div>
    </div>

    <div class='row-fluid' style="margin-top: 0px">
        <div class='span12 box bordered-box green-border' style='margin-bottom:0;'>

            <div class='box-content box-no-padding'>

                <div class='scrollable-area'>

                    <table class='table table-bordered table-hover td-word' style='margin-bottom:0;'>
                        <thead class="acgnthead">
                        <tr>
                            <th></th>
                            <th>分类id</th>
                            <th>分类名称</th>
                            <th>上级分类id</th>
                            <th>是否推荐</th>
                            <th>是否显示</th>
                            <th>排序</th>
                            <th>操作</th>

                        </tr>
                        </thead>

                        <tbody>
                        <div class="tDiv">
                            <div class="tDiv2">
                                <div class="fbutton">
                                    <a href="{:url('Admin/Category/add')}" onfocus="this.blur();">
                                                <span>
                                                    <i class="icon-plus"></i>
                                                    添加分类
                                                </span>
                                    </a>
                                </div>
                                <!--<div class="fbutton">-->
                                    <!--<a href="#" onfocus="this.blur();">-->
                                                <!--<span>-->
                                                    <!--<i class="icon-plus"></i>-->
                                                    <!--折叠分类-->
                                                <!--</span>-->
                                    <!--</a>-->
                                <!--</div>-->
                                <!--<div class="fbutton">-->
                                    <!--<a href="#" onfocus="this.blur();">-->
                                                <!--<span>-->
                                                    <!--<i class="icon-plus"></i>-->
                                                    <!--展开分类-->
                                                <!--</span>-->
                                    <!--</a>-->
                                <!--</div>-->
                            </div>
                        </div>

                        <foreach name="categorylist" item="v1" key="k1">
                        <tr id="{$v1.level}_{$v1.id}">
                            <td>
                                <!--<i class="fa fa-plus"></i>-->
                            </td>
                            <td>{$v1.id}</td>

                            <td style="width: 10%">
                                <div style="text-align: center;">
                                    <!--<input type="text" style="width: 150px" data-id="{$v1.id}" value="{$v1.name}" onblur="changeinput(this,{$v1.id})"/>-->
                                    {$v1.name}
                                </div>
                            </td>

                            <td>{$v1.pid}</td>

                            <td>
                                <div class='text-right' >
                                    <if condition="$v1.is_hot eq 1">
                                        <a href='javascript:void(0);' data-status="ishot-ok" onclick="ajaxChange('ishot-notok',{$v1.id})">
                                            <i class='icon-ok-circle ok-icon'></i>
                                        </a>
                                        <else/>
                                        <a href='javascript:void(0);' data-status="ishot-notok" onclick="ajaxChange('ishot-ok',{$v1.id})">
                                            <i class='icon-ban-circle notok-icon'></i>
                                        </a>
                                    </if>
                                </div>
                            </td>
                            <td>
                                <div class='text-right'>
                                    <if condition="$v1.is_show eq 1">
                                        <a href='javascript:void(0);' data-status="is_show-ok" onclick="ajaxChange('is_show-notok',{$v1.id})">
                                            <i class='icon-ok-circle ok-icon'></i>
                                        </a>
                                        <else/>
                                        <a href='javascript:void(0);' data-status="is_show-notok" onclick="ajaxChange('is_show-ok',{$v1.id})">
                                            <i class='icon-ban-circle notok-icon'></i>
                                        </a>
                                    </if>
                                </div>
                            </td>
                            <td style="width: 10%">
                                <div style="text-align: center; width: 90px;">
                                    <!--<input type="text" style="width: 50px"  value="{$v1.sort_order}">-->
                                    {$v1.sort_order}
                                </div>
                            </td>


                            <td align="center">
                                <div class="caozuo" style="text-align: center; width: 170px; max-width:170px;">
                                    <a id="see" class=" btn" href="{:url('Admin/Category/change',array('id'=>$v1.id))}"><span class="icon-pencil"></span>&nbsp;修改</a>
                                    <a id="delete" href="{:url('Admin/Category/delete',array('id'=>$v1.id))}" class="red btn"><span class="icon-trash"></span>&nbsp;删除</a>
                                </div>
                            </td>
                        </tr>
                            <foreach name="v1.tmenu" item="v2" key="k2">
                                <tr id="{$v2.level}_{$v2.id}">
                                    <td>
                                        <!--<i class="fa fa-plus"></i>-->
                                    </td>
                                    <td>- - - - {$v2.id}</td>
                                    <td style="width: 10%">
                                        <div style="text-align: center; width: 200px;">
                                            <!--<input type="text" style="width: 150px" value="{$v2.name}"  data-id="{$v2.id}" id="catename"/>-->
                                            {$v2.name}
                                        </div>
                                    </td>

                                    <td>{$v2.pid}</td>
                                    <td>
                                        <div class='text-right' >
                                            <if condition="$v2.is_hot eq 1">
                                                <a href='javascript:void(0);' data-status="ishot-ok" onclick="ajaxChange('ishot-notok',{$v2.id})">
                                                    <i class='icon-ok-circle ok-icon'></i>
                                                </a>
                                                <else/>
                                                <a href='javascript:void(0);' data-status="ishot-notok" onclick="ajaxChange('ishot-ok',{$v2.id})">
                                                    <i class='icon-ban-circle notok-icon'></i>
                                                </a>
                                            </if>
                                        </div>
                                    </td>
                                    <td>
                                        <div class='text-right'>
                                            <if condition="$v2.is_show eq 1">
                                                <a href='javascript:void(0);' data-status="is_show-ok" onclick="ajaxChange('is_show-notok',{$v2.id})">
                                                    <i class='icon-ok-circle ok-icon'></i>
                                                </a>
                                                <else/>
                                                <a href='javascript:void(0);' data-status="is_show-notok" onclick="ajaxChange('is_show-ok',{$v2.id})">
                                                    <i class='icon-ban-circle notok-icon'></i>
                                                </a>
                                            </if>
                                        </div>
                                    </td>
                                    <td style="width: 10%">
                                        <div style="text-align: center; width: 90px;">
                                            <!--<input type="text" style="width: 50px" value="{$v2.sort_order}">-->
                                            {$v2.sort_order}
                                        </div>
                                    </td>

                                    <td align="center">
                                        <div class="caozuo" style="text-align: center; width: 170px; max-width:170px;">
                                            <a id="see" class=" btn" href="{:url('Admin/Category/change',array('id'=>$v2.id))}"><span class="icon-pencil"></span>&nbsp;修改</a>
                                            <a id="delete" href="{:url('Admin/Category/delete',array('id'=>$v2.id))}" class="red btn"><span class="icon-trash"></span>&nbsp;删除</a>
                                        </div>
                                    </td>
                                </tr>
                                <foreach name="v2.sub_menu" item="v3" key="k3">
                                    <tr id="{$v3.level}_{$v3.id}">
                                        <td>
                                           <!--<i class="fa fa-plus"></i>-->
                                        </td>
                                        <td>- - - - - - - - {$v3.id}</td>
                                        <td style="width: 10%">
                                            <div style="text-align: center; width: 200px;">
                                                <!--<input type="text" style="width: 150px" value="{$v3.name}"  data-id="{$v3.id}" id="catename"/>-->
                                                {$v3.name}
                                            </div>
                                        </td>

                                        <td>{$v3.pid}</td>
                                        <td>
                                            <div class='text-right' >
                                                <if condition="$v3.is_hot eq 1">
                                                    <a href='javascript:void(0);' data-status="ishot-ok" onclick="ajaxChange('ishot-notok',{$v3.id})">
                                                        <i class='icon-ok-circle ok-icon'></i>
                                                    </a>
                                                    <else/>
                                                    <a href='javascript:void(0);' data-status="ishot-notok" onclick="ajaxChange('ishot-ok',{$v3.id})">
                                                        <i class='icon-ban-circle notok-icon'></i>
                                                    </a>
                                                </if>
                                            </div>
                                        </td>
                                        <td>
                                            <div class='text-right'>
                                                <if condition="$v3.is_show eq 1">
                                                    <a href='javascript:void(0);' data-status="is_show-ok" onclick="ajaxChange('is_show-notok',{$v3.id})">
                                                        <i class='icon-ok-circle ok-icon'></i>
                                                    </a>
                                                    <else/>
                                                    <a href='javascript:void(0);' data-status="is_show-notok" onclick="ajaxChange('is_show-ok',{$v3.id})">
                                                        <i class='icon-ban-circle notok-icon'></i>
                                                    </a>
                                                </if>
                                            </div>
                                        </td>
                                        <td style="width: 10%">
                                            <div style="text-align: center; width: 90px;">
                                                <!--<input type="text" style="width: 50px" value="{$v3.sort_order}">-->
                                                {$v3.sort_order}
                                            </div>
                                        </td>
                                        <td align="center">
                                            <div class="caozuo" style="text-align: center; width: 170px; max-width:170px;">
                                                <a id="see" class=" btn" href="{:url('Admin/Category/change',array('id'=>$v3.id))}"><span class="icon-pencil"></span>&nbsp;修改</a>
                                                <a id="delete" href="{:url('Admin/Category/delete',array('id'=>$v3.id))}" class="red btn"><span class="icon-trash"></span>&nbsp;删除</a>
                                            </div>
                                        </td>

                                    </tr>

                                </foreach>
                            </foreach>
                        </foreach>

                        </tbody>

                    </table>
                </div>



            </div>


        </div>
    </div>
</div>


<script>
    function ajaxChange(type,id) {

        $.ajax({
            type:'get',
            async:false,
            dataType:'json',
            data:{type:type,id:id},
            url:"{:url('Admin/Category/ajaxchangeinput')}",
            success: function(data) {
                if(data.status==200){
                    layer.msg(data.msg,{icon:1,time:2000},function () {
                        window.location.reload();
                    })
                }else{
                    layer.msg(data.msg,{icon:2,time:2000},function () {
                        window.location.reload();
                    })
                }

            }
        })
    }
    $(document).on("click",'#delete1',function() {
        var a = confirm('是否删除该商品？');
        if (a==true){
            var id = $("delete1").parents('tr')[0];
            console.log(id);
            // $.ajax({
            //     type:'post',
            //     async:false,
            //     dataType:'json',
            //     data:{id:id},
            //     url:"{:url('Admin/Goods/deletegoods')}",
            //     success: function(data) {
            //         layer.alert(data.msg)
            //         window.location.reload();
            //     }
            // })
        }else {
            return false;
        }

    })
    $(document).on("click",'#delete2',function() {
        var a = confirm('是否删除该商品？');
        if (a==true){
            var id = $("delete2").parents('tr')[0];
            console.log(id);
            // $.ajax({
            //     type:'post',
            //     async:false,
            //     dataType:'json',
            //     data:{id:id},
            //     url:"{:url('Admin/Goods/deletegoods')}",
            //     success: function(data) {
            //         layer.alert(data.msg)
            //         window.location.reload();
            //     }
            // })
        }else {
            return false;
        }

    })
    $(document).on("click",'#delete3',function() {
        var a = confirm('是否删除该商品？');
        if (a==true){
            var id = $("delete3").parents('tr')[0];
            console.log(id);
            // $.ajax({
            //     type:'post',
            //     async:false,
            //     dataType:'json',
            //     data:{id:id},
            //     url:"{:url('Admin/Goods/deletegoods')}",
            //     success: function(data) {
            //         layer.alert(data.msg)
            //         window.location.reload();
            //     }
            // })
        }else {
            return false;
        }

    })

</script>
</block>



